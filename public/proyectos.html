<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Cerberus Dev | Proyectos</title>
  <link rel="icon" sizes="192x192" href="/assets/img/favicon.png">
  <link rel="stylesheet" href="/assets/css/styles.css"/>
</head>
<body>
  <div data-include="/partials/header.html"></div>

  <main class="page">
    <section class="hero hero--small">
      <div class="hero-bg"></div>
      <div class="container">
        <div class="hero-content">
          <div class="section-label" data-reveal data-i18n="projects.label">Portafolio</div>
          <h1 class="h-title" data-reveal data-i18n="projects.title">Proyectos</h1>
          <p class="h-sub" data-reveal data-i18n="projects.sub">Trabajos representativos desarrollados con enfoque tecnico y profesional.</p>
        </div>
      </div>
    </section>

    <section class="section">
      <div class="container">
        <div class="grid grid-2" data-reveal-stagger id="projectsGrid">
          <div style="grid-column:1/-1;text-align:center;color:rgba(255,255,255,0.4);padding:40px;">
            Cargando proyectos...
          </div>
        </div>
      </div>
    </section>

    <section class="section" style="padding-top:0;">
      <div class="container">
        <div class="card" data-reveal style="text-align:center;padding:48px 32px;">
          <h3 class="card-title" data-i18n="projects.cta_title">Â¿Quieres ver tu proyecto aqui?</h3>
          <p class="card-desc" style="max-width:500px;margin:0 auto 24px;" data-i18n="projects.cta_desc">Conversemos sobre tu idea y construyamos algo solido juntos.</p>
          <a class="btn" href="/contacto" data-i18n="projects.cta_btn">Iniciar proyecto</a>
        </div>
      </div>
    </section>
  </main>

  <div data-include="/partials/footer.html"></div>
  <script src="/assets/js/i18n-data.js"></script>
  <script src="/assets/js/main.js"></script>
  <script>
  (function() {
    const grid = document.getElementById("projectsGrid");

    function esc(s) {
      return String(s || "").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
    }

    fetch("/api/projects")
      .then(r => r.json())
      .then(data => {
        const projects = data.projects || [];

        if (projects.length === 0) {
          grid.innerHTML = `
            <div style="grid-column:1/-1;text-align:center;padding:60px 24px;">
              <div class="card" style="display:inline-block;padding:48px 40px;max-width:500px;">
                <div style="font-size:48px;margin-bottom:16px;">&#x1F4C2;</div>
                <h3 class="card-title" data-i18n="projects.no_projects">Proximamente</h3>
                <p class="card-desc" data-i18n="projects.no_projects_desc">Estamos preparando nuestro portafolio. Vuelve pronto para ver nuestros proyectos.</p>
              </div>
            </div>
          `;
          return;
        }

        grid.innerHTML = projects.map((p, i) => {
          const num = String(i + 1).padStart(2, "0");
          const techIcons = (p.technologies || []).map(t =>
            `<img src="${esc(t.tech_icon)}" alt="${esc(t.tech_name)}" title="${esc(t.tech_name)}" style="width:24px;height:24px;object-fit:contain;">`
          ).join("");

          return `
            <a href="/proyectos/${esc(p.slug)}" class="card project-card" style="text-decoration:none;color:inherit;">
              <span class="project-number">${num}</span>
              ${p.tag ? '<span class="project-tag">' + esc(p.tag) + '</span>' : ''}
              ${p.image_url ? '<img class="project-img" src="' + esc(p.image_url) + '" alt="' + esc(p.title) + '" onerror="this.style.display=\'none\'">' : ''}
              <h3 class="card-title">${esc(p.title)}</h3>
              <p class="card-desc">${esc(p.description || '')}</p>
              ${techIcons ? '<div class="project-tech-icons" style="display:flex;gap:8px;margin-top:16px;flex-wrap:wrap;">' + techIcons + '</div>' : ''}
            </a>
          `;
        }).join("");
      })
      .catch(() => {
        grid.innerHTML = '<div style="grid-column:1/-1;text-align:center;color:rgba(255,255,255,0.4);padding:40px;">Error al cargar proyectos.</div>';
      });
  })();
  </script>
</body>
</html>
